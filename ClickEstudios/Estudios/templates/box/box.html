{% extends "base/base.html" %}
{% block content %}
      {% load humanize %}
      <style>
            .nav .caja {
                  color: #ffc107;
                  font-weight: bolder;
                  transform: scale(1.1);
            }
            .btn-atras
            {
                  display: none;
            }
            .balance-total .cierre-anterior  {
                  display: flex; justify-content: center;
                  text-align: center;
            }

            .detail-resulst{
                  width: 100%;
                  max-width: 30rem;
                  position: absolute; bottom: 0; right: 0;
                  margin-bottom: 0.8rem; margin-right: 0.7rem;
                  display: flex; 
            }

            /* Adaptando estylos  a movile */
            @media (max-width: 600px) {
                        .balance-total .cierre-anterior span {
                        width: 100%;
                  }
                  .detail-resulst {
                        width: 100%;
                        position: static; 
                        display: block;
                  }
            }
      </style>

      <div data-aos="fade-in" class="container-box w-100 text-white overflow-auto d-flex flex-wrap align-content-start  justify-content-center  rounded-5" 
            style="transition: 1s;">
            {% if is_open %}
            <div class="w-100 h-100 overflow-auto">
                        <div class="d-flex justify-content-start mb-3">
                              <div class="p-2 cierre-anterior bg-secondary text-center ps-4 pe-4 bg-white bg-opacity-10 text-white rounded-5">
                                    <strong style="font-size: 14px;">Cierre anterior</strong>
                                    <span> ${{total_last_session|intcomma}}.00 </span>
                              </div>
                              <div class="p-2 balance-total bg-primary text-white  text-center rounded-5 ps-4 pe-4 bg-white bg-opacity-10">
                                    <strong style="font-size: 14px;">
                                          Balance total
                                    </strong>
                                    <span> ${{total_movimientos|intcomma}}.00 </span>
                              </div>
                        </div>
                        <div class="overflow-visible container-table " style="height: 80vh;">
                              {% include "box/components/filter.html" %}
                             <div style="height: 55vh;" class="overflow-auto ">
                                    {% include "box/components/table.html" %}
                             </div>
                             <div class="detail-resulst ">
                                    <table class="w-100">
                                          <thead>
                                                <tr>
                                                      <th scope="col" class="text-center">Total ingresos</th>
                                                      <th scope="col" class="text-center">Total gastos</th>
                                                      <th scope="col" class="text-center">Balance total</th>
                                                </tr>
                                          </thead>
                                          <tbody>
                                                <tr>
                                                      <td class="text-center">${{ ingresos|intcomma }}.00</td>
                                                      <td class="text-center">${{ egresos|intcomma }}.00</td>
                                                      <td class="text-center">${{ balance_caja|intcomma }}.00</td>
                                                </tr>
                                          </tbody>
                                    </table>
                                    <a href="{% url "estudios:box-create" %}" class='btn-cerrar'> 
                                          <button style=" font-weight: bold;"  
                                          class='w-100 btn bg-white bg-opacity-10  rounded-5 text-white m'> Cerrar  </button>
                                    </a>
                             </div>
                        </div>
                  </div>
            {% else %}
                  {% include "component/abrir-caja.html" %}
            {% endif %}
      </div>
      <script>
            function filterMovimientos(tipo) {
                  const rows = document.querySelectorAll('.movimiento-row');
                  rows.forEach(row => {
                        if (tipo === 'todos' || row.getAttribute('data-tipo') === tipo) {
                              row.style.display = '';
                        } else {
                              row.style.display = 'none';
                        }
                  });
            }
      </script>
{% endblock  %}
