{% load humanize %}
<style>
      .sale-plus{
            display: flex;
            width: 60px;
            height: 60px;
            color: white;
            flex-wrap: wrap;
            align-items: center;
            border-radius: 1rem;
            justify-content: center;
            background-color: rgba(104, 104, 104, 0.23);
      }
      .sale-plus a {
            color: rgba(255, 255, 255, 0.75) !important;
            text-decoration: none;

      }
      i {
            font-size: 14px;
            margin-right: 0.3rem;
      }
      .estado-monto {
            background-color: #202020;
            padding: 0.5rem 0.9rem;
            margin: 0.1rem 0.1rem;
            border-radius: 1.2rem;
            width: 100%;
            text-align: center;
      }
      @media (min-width: 600px) {
            .container-sale {
                  min-width: 510px; max-width: 510px;
            }
      }
</style>
            <div data-aos="fade-left"  style="
                  border: 4px solid rgb(47, 47, 47);color: #ffffffcf ;
                  height: max-content; max-width: 410px; 
                  {% if not s.is_reserve %}
                        background-color: #101010 !important;
                  {% endif %}
                  border-radius: 2.6rem; cursor: pointer; " class='  m-2 w-100 p-2 container-sale ms-0 shadow-sm    position-relative bg-white bg-opacity-10'>
                  {% include 'sale/components/note.html' %}
                  {% if s.is_reserve == False %} 
                  
                  <a href="{% url "estudios:sale-delete" s.id %}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-x-circle-fill position-absolute top-0 end-0 " viewBox="0 0 16 16">
                              <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293z"/>
                        </svg>
                  </a>
                  {% endif %}
                  <div class="d-flex justify-content-end position-absolute flex-wrap align-content-center    bottom-0 end-0 "
                        style='margin-right: 8rem; margin-bottom: 1.2rem;'>
                        {% if s.date_choice == today %}
                                    {% if s.time == time_now %}z
                                          <span class="rounded-circle" style="width: 10px; height: 10px; background-color: #ffc107;"></span>  
                                    {% endif %}
                                    {% if s.time > time_now %}
                                          <span class="rounded-circle" style="width: 10px; height: 10px; background-color:rgb(255, 255, 255);"></span>  
                              {% endif %}
                              {% if s.time < time_now %}
                                    <span class="rounded-circle" style="width: 10px; height: 10px; background-color:rgb(109, 255, 236);"></span>
                                    {% endif %}
                        {% endif %}
                        {% if s.date_choice < today %}
                              <span class="rounded-circle" style="width: 10px; height: 10px; background-color: rgb(255, 0, 0);"></span>
                              <span class="rounded-circle ms-1" style="width: 10px; height: 10px; background-color:rgb(255, 170, 0);"></span>
                        {% endif %}
                  </div>
                        <div class='d-flex flex-wrap w-100' >
                              <a {% if s.pk_plan %} href="{% url "estudios:sale-update" s.id %}"  {% endif %}  class="position-relative d-flex">
                                    <div class="d-flex flex-wrap align-content-center">
                                          {% if s.img %}
                                          <img src="{{s.img.url}}" 
                                                style='width: 70px; height: 70px;' class='rounded-circle object-fit-cover mt-1 ms-2 me-3'>
                                          {% else %}
                                                <i class="bi bi-file-earmark-image-fill mt-3 ms-3" 
                                                style="font-size: 30px;"></i>
                                          {% endif %}
                                    </div>
                                    <div class="d-flex flex-wrap align-content-center">
                                          <strong style='font-size: 16px; text-transform: uppercase; '>
                                                {{s.name_plan}}
                                          </strong>
                                          <span class="w-100" style="font-size: 14px;">
                                                RD${{ s.price_plan|intcomma }}.00
                                          </span>
                                    </div>
                              </a>
                              <span class='w-100 mt-4 ps-3 datos-cliente' >
                                           <p class="mb-0">
                                          <strong class="text-capitalize " style="font-weight: bold; font-size: 20px;">
                                                {% if s.is_cliente %}
                                                      {{ s.name }} 
                                                {% else %}
                                                {% if s.name_client %}
                                                      {{ s.name_client|slice:":20" }}
                                                {% endif %}
                                                </strong>
                                          </p>
                                          <p class="mb-0 ">
                                                <strong>
                                                      <i class="fi fi-sc-phone-flip"></i>
                                                </strong> 
                                                {% if s.phone_client %}
                                                      {{ s.phone_client }} 
                                                {% else %}
                                                      (000) 000-0000 
                                                {% endif %}
                                          </p>
                                          <p class="mb-1">
                                                <strong>
                                                      <i class="fi fi-sr-envelope"></i>
                                                </strong> 
                                                {% if s.email_client %}
                                                      {{ s.email_client|slice:":49" }}
                                                {% else %}
                                                      @gmail.com
                                                {% endif %}
                                          </p>
                                          <p class="mb-1">
                                                <strong>
                                                      <i class="fi fi-sr-daily-calendar"></i>
                                                </strong> 
                                                {% if s.date_choice %}
                                                            {{ s.date_choice|date:"d/m/Y" }} -  {{ s.time }}
                                                      {% else %}
                                                            .../.../.../
                                                {% endif %}
                                          </p>
                                    <div class='calendary{{s.id}} d-none position-absolute top-0 start-0 blur-20 bg-black bg-opacity-25 rounded-5   d-flex justify-content-center align-content-center flex-wrap '
                                          style="width: 10rem; height: 10rem;">
                                          {% if s.date_choice %}
                                                <strong class="mb-3 text-white-50">
                                                      {{ s.date_choice|date:"F" }} 
                                                </strong>
                                                <span class="text-white text-center p-2 ps-0 w-100" style="font-size: 90px; line-height:40px;">
                                                      {{ s.date_choice|date:"d" }} 
                                                </span>
                                          {% endif %}
                                    </div>
                                    </span>
                                
                              {% endif %}
                        </div>

                        <div class='d-flex justify-content-center mt-3 '>
                              <span class=" w-100 d-flex  align-content-center text-white-50">
                                    {% if s.is_reserve %}
                                          {% if s.debit_mount  != 0 %}
                                                <span class="estado-monto"><strong 
                                                      style="font-size: 12px;">Debe:  </strong> ${{ s.debit_mount|intcomma }}.00</span>
                                                <span class="estado-monto"><strong 
                                                      style="font-size: 12px;">Abon√≥:  </strong>${{ s.mount|intcomma }}.00</span>
                                          {% endif %}
                                    {% endif %} 
                              </span>
                              {% if s.payment %}
                                    <a href="{% url "estudios:estudios" s.id %}">
                                          <button id='reserve-{{ s.id }}'  class="bg-warning rounded-start-5 border-0 rounded-end-5 p-2 ps-3 pe-3  text-black " style="font-weight: bold; font-size: 14px;">
                                                Teminar
                                          </button>
                                    </a>
                              {% else %}
                                    <a href="{% url "estudios:sale-reserver" s.id %}" class="m-1">
                                          <button id='reserve-{{ s.id }}' 
                                                class="bg-white bg-opacity-10 text-white  border-0 rounded-5 p-2 pe-3 ps-3" style="font-weight: bold; font-size: 14px;">
                                                {% if s.is_reserve == True %} 
                                                      Completar {% else %}  Reservar
                                                {% endif %}
                                          </button>
                                    </a>
                              {% endif %}
                        </div>
            </div>


      <script>
            function Calendar(ID) {
                   document.querySelector('.calendary'+ID).classList.toggle('d-none');
            }
      </script>
